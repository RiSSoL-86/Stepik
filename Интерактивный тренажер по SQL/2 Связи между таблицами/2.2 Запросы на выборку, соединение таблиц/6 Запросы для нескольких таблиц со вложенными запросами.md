# Запросы для нескольких таблиц со вложенными запросами

## Задание

Вывести в алфавитном порядке всех авторов, которые пишут только в одном жанре. Поскольку у нас в таблицах так занесены данные, что у каждого автора книги только в одном жанре,  для этого запроса внесем изменения в таблицу `book`. Пусть у нас  книга Есенина «Черный человек» относится к жанру «Роман», а книга Булгакова «Белая гвардия» к «Приключениям» (эти изменения в таблицы уже внесены).

## Решение

```
select 
    name_author
from
    author
where
    author_id in (
        select
            a.author_id
        from
            author a
        join
            book b
            on b.author_id = a.author_id 
        join
            genre g
            on g.genre_id = b.genre_id
        group by 
            a.author_id 
        having
            count(distinct b.genre_id) = 1
)
```
